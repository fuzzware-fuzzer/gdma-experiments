# Source Code for the DMA Application Samples

This directory contains the files required to re-build the samples from the new DMA data set. These sources correspond to the pre-built samples the in the repo eval base directory: [../../03-coverage-experiments/](../../03-coverage-experiments/).

## Requirements

To build the samples, make sure to have a valid installation of Docker on the local host.

## Rebuilding the Sample Set

Rebuild all samples by running `python cli.py update-3`. 
Add `-u` if you want to copy the results to the directory used for evaluation.

To verify that the samples match the pre-built binaries, run `python cli.py update-3 -pd`.

The output of running these commands should indicate that the extracted binaries as well as the auto-generated configurations of the newly built images match the pre-built binaries and configs.


## Adding a sample

To add a sample, take the following steps:
1. Create a folder in `targets` directory. 
2. Add your source there.
    - Include `sample.diff`, which contains a `git diff` of the changes that were made to the firmware sample source code
3. Also, include (at least) the following script files:
    - `build_docker.sh`: This must prepare the build environment, mount the current working directory and run `build_samples.sh` in the Docker container.
    - `build_samples.sh`: Within the docker container, this must build the firmware sample and places an ELF file into the `output` directory as `output/*.elf`.
4. Documentation: Finally, add a `build_samples.md` which explains how you created the sample. Make sure to add enough information for somebody else to set up the correct environment (such as a Ubuntu 24.04). This includes how to
    - install any (GUI-based) IDE
    - add a project within the IDE and where to find the projects
    - copy/extract the required projects files that were generated by the IDE
    - Also include any specific installation or project paths that are required such that the docker build runs cleanly

### Recommendations for the Build Environment

The current samples have additional structure.
First, there is a common base image which prepares some things already, such as a compiler: [common/Dockerfile](./common/Dockerfile). You can also use this as a base image via the `password-base` tag:
```
from password-base
```

